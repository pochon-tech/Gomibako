**準備**
- `docker-compose exec node sh`

**AWKについて**

- フィルタプログラムを構成できる
- AWK が得意とする入力データは，表（テーブル，table）形式のテキストデータ
- 表データの各行（横方向）のデータ集合をレコード、各列（縦方向）のデータ集合をフィールド（field）と呼ぶ
|  Name  |  Age  |
| ---- | ---- |
|  Mike  |  20  |
|  Juin  |  40  |
- 表データをテキストファイルで表現する場合、各フィールドの間を「タブ」もしくは「空白」で区切る
- レコード単位の処理: パターン（正規表現や条件式）にマッチしたレコードに対してだけ， アクション（処理）を実行
  - `パターン { アクション }`: パターンに一致した行だけに対してアクションを実行
  - `アクション`: デフォルトのパターン。全ての行に対してアクションを実行

**構文**
- `$ awk '{ awkのコード }' ファイル名`

**練習**
- ファイル内容出力
```sh:
$ vi sample.dat
1 10 100
2 20 200
3 30 300
# 変数「$0」には、現在処理している一行の内容が格納
$ awk '{ print $0; }' sample.dat
```

- 各行の、各列を出力
```sh:
# $0: 現在処理している1行
# $1,$2...: 処理している1行を「空白で分割」して格納される
# "hoge": ""で括られた文字は文字列として表示
$ awk '{ print $1","$2","$3; }' sample.dat
1,10,100
2,20,200
3,30,300
```

- 計算結果の出力
```sh:
$ awk '{ print "+: "$1+$2+$3; print "-: "$3-$2-$1; print "*: "$1*$2*$3; print "/: "$3/$2/$1 }' sample.dat 
+: 111
-: 89
*: 1000
/: 10
+: 222
-: 178
*: 8000
/: 5
+: 333
-: 267
*: 27000
/: 3.33333
# 小数点の桁数を指定して出力
$ awk '{ printf "%.6f\n", $1 }' sample.dat
1.000000
2.000000
3.000000
# 余り計算
$ awk '{ print $2%3 }' sample.dat 
1 # 10 % 3 = 3...1
2 # 20 % 3 = 6...2
0 # 30 % 3 = 10...0
# 変数に格納
$ awk '{ sum = $1+$2+$3; print sum} ' sample.dat
111
222
333
```

- 正規表現を使う
- `awk '/正規表現/ { アクション }'`
```sh:
# 2を含む行を表示
$ awk '/2/ { print $0 }' sample.dat
2 20 200
# 100で終わる行を表示
$ awk '/100$/ { print $0 }' sample.dat
1 10 100
```

- BEGINとEND
- `awk 'BEGIN { 最初の行を読み込む前の処理 } { メイン処理 } END { 最後の行を読み込んだ後の処理 }'`
```sh:
# BEGIN: 最初の行が読み込まれる前に処理を実行
# END:   最後の行が読み込まれた後に処理を実行
# 一番最初の行と、一番最後の行に文字を表示する。
awk 'BEGIN { print "==BEGIN==" } { print $0} END { print "==END==" }' sample.dat 
==BEGIN==
1 10 100
2 20 200
3 30 300
==END==
```